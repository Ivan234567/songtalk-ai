# Agent Tab — UI/UX спецификация

Цель: сделать вкладку «Агент» эталонной по ощущению и удобству — понятно с первого взгляда, приятно в использовании, без лишнего шума.

---

## 1. Визуальная обратная связь (Feedback)

### 1.1 Визуализация голоса при записи
- **Что:** Во время записи (состояние «Говорите…») вокруг орба или внутри него отображается уровень громкости в реальном времени — волны, кольца или столбики.
- **Зачем:** Пользователь видит, что микрофон слышит его; снижается неуверенность («оно вообще записывает?»). Визуал создаёт ощущение «живого» интерфейса.
- **Детали:** Анимация должна быть плавной (не дёргаться), не отвлекать. Варианты: концентрические кольца, пульсирующая обводка по уровню dB, или мягкая «рябь» от центра.

### 1.2 Анимация «агент говорит» (TTS)
- **Что:** Пока воспроизводится озвучка ответа, орб слегка пульсирует или меняет яркость/размер в такт речи (или по простому таймеру).
- **Зачем:** Связь «этот голос — от этой сферы»; интерфейс чувствуется единым, а не «просто плеер».
- **Детали:** Анимация должна быть синхронной с аудио (по возможности через анализ громкости или через события воспроизведения). Интенсивность — низкая, чтобы не раздражать.

### 1.3 Состояния орба — чёткая семантика
- **Что:** У каждого состояния (idle, listening, thinking, speaking, error) свой неповторимый вид: цвет, свечение, форма (если нужно), иконка/символ внутри (опционально).
- **Зачем:** Пользователь всегда понимает, что происходит, без чтения текста.
- **Детали:** Idle — спокойный, «приглашающий». Listening — активный, «слушаю». Thinking — «работаю» (например, лёгкое вращение или мерцание). Speaking — «говорю» (пульс). Error — мягкое красное свечение + понятное сообщение.

---

## 2. Звук и тактильность

### 2.1 Звуковые сигналы (Sound design)
- **Что:** Короткие, ненавязчивые звуки: старт записи (например, мягкий «тик»), конец записи (другой «тик» или «поп»), при необходимости — звук ошибки.
- **Зачем:** Подтверждение действия без необходимости смотреть на экран; особенно важно при использовании вслепую или с мобильного.
- **Детали:** Громкость низкая, тона приятные (не системные «бипы»). Возможность отключить в настройках.

### 2.2 Хаптик (мобильные)
- **Что:** Лёгкая вибрация при начале записи и при её окончании (и опционально при ошибке).
- **Зачем:** Тактильное подтверждение на телефоне/планшете; меньше необходимости смотреть на экран.
- **Детали:** Использовать лёгкий паттерн (не «долгая вибрация»). Обязательный переключатель в настройках.

---

## 3. Подсказки и обучение

### 3.1 Ротация примеров фраз
- **Что:** Под статусом (или под орбом) по очереди показываются короткие примеры: «Скажи: “Как будет по-английски яблоко?”», «“Переведи: The cat is sleeping”», «“Повтори за мной это предложение”» и т.д.
- **Зачем:** Новый пользователь сразу понимает, что можно сказать; снижается «пустой экран» и неуверенность.
- **Детали:** Плавная смена текста (fade или slide), не слишком быстрая (5–8 сек на фразу). Не показывать во время записи/думаю/говорю. Можно привязать к выбранному режиму (разговор/перевод/диктант).

### 3.2 Первый запуск (Onboarding)
- **Что:** При первом заходе на вкладку «Агент» — мини-туториал: один экран с текстом «Удерживайте сферу и говорите» + анимация нажатия на орб. Кнопка «Понятно» или автоматическое скрытие после первого использования.
- **Зачем:** Сразу задать ментальную модель «push-to-talk», меньше проб и ошибок.
- **Детали:** Не блокировать интерфейс; можно повторить из настроек или по иконке «?».

### 3.3 Индикатор длительности записи
- **Что:** Пока пользователь держит кнопку, показывать время записи: «1 с», «2 с» или прогресс-бар «минимум набран» (например, заполнение до 1 сек), затем просто счётчик.
- **Зачем:** Избежать ошибки «запись слишком короткая»; пользователь видит, когда можно отпустить.
- **Детали:** Не перегружать: маленький текст или тонкая полоска под орбом/в статусе. После достижения минимума можно показывать зелёную галочку или смягчать цвет.

---

## 4. Режимы и контекст

### 4.1 Режимы агента
- **Что:** Переключатель режимов: «Разговор», «Перевод», «Диктант», «Вопрос по словарю» (и при необходимости «Свободный»). От выбора зависит системный промпт и примеры фраз.
- **Зачем:** Разные сценарии использования (попрактиковать речь, перевести фразу, проверить написание, повторить слово из словаря) — один интерфейс, но предсказуемое поведение.
- **Детали:** Переключатель — табы или сегментированная кнопка над орбом или под ним. Текущий режим визуально выделен; подсказки подстраиваются под режим.

### 4.2 Язык ответа
- **Что:** Настройка «Отвечать на: русском / английском / на языке пользователя». Опционально — отдельная настройка языка для TTS (голос).
- **Зачем:** Удобство для изучающих язык: например, вопросы на русском, ответы на английском, или наоборот.
- **Детали:** В настройках приложения или в компактной панели рядом с режимом агента.

### 4.3 Имя и тон агента
- **Что:** В настройках можно задать имя агента и обращение («ты» / «вы»). Опционально — тон: нейтральный, дружелюбный, строгий.
- **Зачем:** Персонализация и комфорт для разных возрастов и контекстов.
- **Детали:** Влияет на промпт на бэкенде; на фронте можно показывать выбранное имя рядом с орбом или в заголовке.

---

## 5. История и повтор

### 5.1 Компактная история реплик
- **Что:** Под блоком субтитров (или в боковой панели на десктопе) — список последних 3–5 пар «пользователь → агент». Каждая строка: иконка + обрезанный текст (первая фраза). По клику — развернуть полный текст и/или «Озвучить» снова.
- **Зачем:** Можно быстро вернуться к предыдущему ответу, повторить озвучку, скопировать фразу.
- **Детали:** Сворачиваемый блок «История» или всегда видимые карточки. На мобильном — аккордеон или отдельный экран «История».

### 5.2 Действия над последним ответом
- **Что:** Рядом с «Показать субтитры» — кнопки: «Повторить» (проиграть TTS ещё раз), «Скопировать» (текст в буфер), при необходимости «Поделиться».
- **Зачем:** Не нужно заходить в историю для простых действий; меньше кликов.
- **Детали:** Иконки с подсказками (tooltip). «Повторить» особенно полезно для изучения языка.

### 5.3 Отмена запроса / воспроизведения
- **Что:** В состояниях «Думаю…» и «Говорю…» — кнопка «Стоп» (иконка стоп или крестик). Останавливает запрос к API или воспроизведение TTS.
- **Зачем:** Пользователь может передумать или прервать долгий ответ; ощущение контроля.
- **Детали:** Кнопка рядом со статусом или под орбом, не перегружая основной экран.

---

## 6. Клавиатура и доступность

### 6.1 Горячие клавиши
- **Что:** Пробел — push-to-talk (зажать = запись, отпустить = отправить). Опционально: Escape — отмена записи/воспроизведения; отдельная клавиша для «Повторить».
- **Зачем:** Удобство на десктопе без мыши; возможность не трогать орб.
- **Детали:** Подсказка при первом фокусе на вкладке или в footer: «Пробел — говорить». Учитывать, что пробел в полях ввода не должен включать запись.

### 6.2 Доступность (a11y)
- **Что:** Корректные ARIA-роли и метки (кнопка орба, статус, кнопки субтитров/повтора). Озвучивание статусов скринридером («Запись», «Думаю», «Говорю», «Готово»). Фокус не должен «проваливаться» за пределы видимой области.
- **Зачем:** Использование с клавиатурой и скринридером; соответствие стандартам.
- **Детали:** Тестировать с NVDA/VoiceOver; не полагаться только на визуальные подсказки для критичных состояний.

---

## 7. Ошибки и границы

### 7.1 Понятные сообщения об ошибках
- **Что:** Для каждой типичной ошибки — короткое сообщение + одна подсказка. Примеры: «Микрофон занят другим приложением» → «Закройте другие вкладки с доступом к микрофону»; «Сеть недоступна» → «Проверьте интернет и попробуйте снова»; «Запись слишком короткая» → «Держите кнопку не менее секунды».
- **Зачем:** Пользователь знает, что произошло и что делать, без поиска в интернете.
- **Детали:** Тосты или inline под орбом, не только алерт. Иконка типа ошибки (микрофон, сеть, часы).

### 7.2 Лимит длины записи
- **Что:** Максимум записи, например 60 секунд. За 10 секунд до лимита — предупреждение (текст «Осталось 10 с» или мигание). По достижении лимита — автостоп и отправка.
- **Зачем:** Избежать бесконечной записи и таймаутов на бэкенде; пользователь понимает границы.
- **Детали:** Настройка лимита в настройках (30/60/90 с) или фиксированный 60 с. Таймер показывать только после, например, 5 секунд записи.

### 7.3 Состояние «микрофон отключён»
- **Что:** Если пользователь отклонил доступ к микрофону или он недоступен — не просто «ошибка», а отдельное состояние: сообщение «Разрешите доступ к микрофону» + кнопка «Открыть настройки» (где возможно) или пошаговая инструкция.
- **Зачем:** Восстановление без паники и ухода со страницы.
- **Детали:** Определять отказ до первого нажатия (при загрузке или при первом нажатии) и показывать экран-подсказку.

---

## 8. Внешний вид и настройки

### 8.1 Тема орба
- **Что:** В настройках — выбор цвета/темы сферы: индиго (по умолчанию), зелёный, янтарный, монохром (под светлую/тёмную тему) или «как в системе».
- **Зачем:** Вкус и контраст; возможность подстроить под общую тему приложения.
- **Детали:** Превью орба в настройках; сохранение в localStorage или в профиле пользователя.

### 8.2 Размер орба
- **Что:** В настройках — маленький / средний / большой орб (например 160 / 200 / 240 px).
- **Зачем:** Удобство на больших экранах (крупнее) и на мобильных (компактнее).
- **Детали:** Одна настройка; влияет только на вкладку «Агент».

### 8.3 Фон блока агента
- **Что:** Опционально — тонкий градиент, очень мягкий паттерн (точки, сетка) или размытая нейтральная картинка за блоком агента, не отвлекающая от орба.
- **Зачем:** Глубина и «премиальность» без перегруза.
- **Детали:** Выключено по умолчанию или только градиент; паттерн/картинка — в настройках темы.

---

## 9. Приоритизация

**Фаза 1 — быстрые победы (максимум отдачи при минимуме кода):**
- Подсказки-фразы (ротация примеров).
- Индикатор длительности записи (секунды / «минимум набран»).
- Кнопки «Повторить» и «Скопировать» у последнего ответа.
- Улучшение текстов ошибок и подсказок к ним.
- Горячая клавиша Пробел для push-to-talk.

**Фаза 2 — ощущение «живого» интерфейса:**
- Визуализация голоса при записи.
- Анимация орба при воспроизведении TTS.
- Короткие звуковые сигналы (старт/стоп записи).
- Кнопка «Стоп» при думаю/говорю.

**Фаза 3 — режимы и контекст:**
- Режимы агента (Разговор, Перевод, Диктант, Вопрос по словарю).
- Язык ответа и опционально имя/тон агента.
- Компактная история реплик.

**Фаза 4 — полировка и персонализация:**
- Онбординг при первом заходе.
- Тема и размер орба, опциональный фон.
- Хаптик на мобильных.
- Лимит длины записи с предупреждением.
- Экран «микрофон отключён» с подсказками.
- Доступность (a11y) и клавиатурная навигация.

---

## 10. Принципы

- **Понятность:** Состояние системы всегда ясно из вида орба и одной строки текста.
- **Обратная связь:** Каждое действие (нажал, записал, отправил, ошибка) имеет визуальный или звуковой отклик.
- **Минимум шагов:** Частые действия (повторить, скопировать, остановить) — в один клик.
- **Дружелюбие к ошибкам:** Ошибки объясняются и подсказывают следующий шаг; микрофон и сеть — отдельные сценарии с инструкциями.
- **Гибкость без перегруза:** Режимы и настройки — для тех, кому нужно; новичку достаточно «нажать и говорить».

Эта спецификация — ориентир для реализации: можно брать пункты по фазам и воплощать по одному, сохраняя единый стиль и приоритет лучшего UI/UX.
